{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, reactive, onMounted } from \"vue\";\nimport { GoogleMap, Marker, Polyline } from \"vue3-google-map\";\nimport Parse from \"parse\";\nimport User from \"../server/user\";\nimport userView from \"../components/UserView.vue\"; // import Parse from \"parse\";\n\nexport default defineComponent({\n  components: {\n    GoogleMap,\n    Marker,\n    Polyline,\n    userView\n  },\n\n  setup() {\n    const currentUser = Parse.User.current();\n    const center = {\n      lat: 40.689247,\n      lng: -74.044502\n    };\n    const formState = reactive({\n      image: \"\",\n      center: {\n        lat: 40.689247,\n        lng: -74.044502\n      },\n      loader: false,\n      data: [],\n      getData: [],\n      flag: false,\n      sharing: false,\n      start: null,\n      stop: null,\n      user: null\n    });\n    const line = reactive({\n      flightPath: {\n        path: formState.data,\n        geodesic: true,\n        strokeColor: \"#FF0000\",\n        strokeOpacity: 1.0,\n        strokeWeight: 2\n      }\n    });\n    onMounted(async () => {\n      const currentUser = Parse.User.current();\n\n      if (currentUser) {\n        formState.start = true;\n        formState.stop = false, formState.user = true;\n      } // const currentUser = Parse.User.current();\n      // await User.getPointer(currentUser.id).then((obj)=>{\n      //   var ldata =  currentUser.get('userLocation')\n      // })\n      // if(currentUser){\n      //   var ldata =  currentUser.get('userLocation')\n      //    console.log(\"ldata\",ldata)\n      //    formState.data=currentUser.get('userLocation')\n      //    console.log(formState.data[0])\n      // }\n      // getLocation();\n\n\n      startLocation(); // window.setInterval(() => {\n      //   navigator.geolocation.getCurrentPosition(() => {});\n      //   getLocation();\n      // }, 9000); \n    });\n\n    const updateLocation = async () => {\n      if (navigator.geolocation) {\n        await navigator.geolocation.getCurrentPosition(position => {\n          formState.data.push({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          });\n          console.log(position.coords.latitude);\n          console.log(position.coords.longitude);\n          formState.center.lat = position.coords.latitude;\n          formState.center.lng = position.coords.longitude;\n        });\n      }\n    };\n\n    const getLocation = async () => {\n      const checkUseer = Parse.User.current(); // formState.loader = false;\n\n      if (checkUseer) {\n        if (navigator.geolocation) {\n          // console.log(\"h\")\n          await navigator.geolocation.getCurrentPosition(async position => {\n            console.log(position.coords.latitude);\n            console.log(position.coords.longitude);\n            console.log(formState.data);\n            let myTarget = JSON.parse(JSON.stringify(formState.data));\n            console.log(myTarget);\n            formState.data.push({\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            });\n            formState.getData.push({\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            }); // console.log(formState.center.lat)\n\n            formState.center.lat = position.coords.latitude;\n            formState.center.lng = position.coords.longitude; // const currentUser = Parse.User.current();\n\n            console.log(\"curremt user\", currentUser.get(\"username\"), currentUser.id);\n            await User.getPointer(currentUser.id).then(obj => {\n              currentUser.set({\n                \"userLocation\": formState.data\n              });\n              currentUser.save().then(() => {\n                console.log(\"saving............................\");\n              });\n              console.log(obj);\n            });\n            formState.loader = true;\n          });\n        }\n      }\n    }; // setInterval(updateLocation, 5000);\n\n\n    const startLocation = async () => {\n      formState.flag = false;\n      console.log(\"hi\"); // setTimeout(updateLocation, 1000);\n\n      currentUser.set({\n        'state': true\n      });\n      await currentUser.save();\n      var intervel = window.setInterval(() => {\n        console.log(\".......\");\n\n        if (formState.flag) {\n          console.log(\",,,,,,,,,,,,,,\");\n          formState.start = true;\n          formState.stop = false;\n          window.clearInterval(intervel);\n        } else {\n          console.log(\"!!!!!!!!!!!!!!!!\");\n          formState.start = false;\n          formState.stop = true;\n          getLocation();\n        } // navigator.geolocation.getCurrentPosition(() => {});\n\n      }, 3000); // clearInterval(startLocation());\n    };\n\n    const stopLocation = async () => {\n      // formState.stop=false\n      currentUser.set({\n        'state': false\n      });\n      await currentUser.save();\n      console.log(\"stop\"); // clearInterval(startLocation());\n\n      formState.flag = true; // formState.start=true\n      // clearInterval(myInterval);\n    };\n\n    return {\n      center,\n      formState,\n      updateLocation,\n      startLocation,\n      getLocation,\n      line,\n      stopLocation\n    };\n  }\n\n});","map":{"version":3,"mappings":"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","names":["defineComponent","reactive","onMounted","GoogleMap","Marker","Polyline","Parse","User","userView","components","setup","currentUser","current","center","lat","lng","formState","image","loader","data","getData","flag","sharing","start","stop","user","line","flightPath","path","geodesic","strokeColor","strokeOpacity","strokeWeight","startLocation","updateLocation","navigator","geolocation","getCurrentPosition","position","push","coords","latitude","longitude","console","log","getLocation","checkUseer","myTarget","JSON","parse","stringify","get","id","getPointer","then","obj","set","save","intervel","window","setInterval","clearInterval","stopLocation"],"sourceRoot":"","sources":["C:\\Users\\user\\Downloads\\parse\\src\\components\\HomeView.vue"],"sourcesContent":["\n\n<template>\n  <div>\n    <!-- <p>{{formState.user && !formState.sharing ? \"Sharing Location........\" : \"Stopped Location.................\"}}</p> -->\n    <div v-if=\"formState.user\">\n      <button v-if=\"formState.stop \"  @click=\"stopLocation()\">STOP</button>\n    <button v-if=\"formState.start  \" @click=\"startLocation()\">START</button>\n    </div>\n\n    <userView />\n    <!-- <button @click=\"getLocation()\">Track Location</button> -->\n    \n    <GoogleMap  \n      api-key=\"AIzaSyABPywZVGnAsgP8llgiBFnx8sAvUUiRyv4\"\n      style=\"width: 100%; height: 500px\"\n      :center=\"formState.center\"\n      :zoom=\"25\"\n    >\n      <Polyline :options=\"line.flightPath\" />\n      <Marker :options=\"{ position: formState.center }\" />\n    </GoogleMap>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, onMounted } from \"vue\";\nimport { GoogleMap, Marker, Polyline } from \"vue3-google-map\";\n\nimport Parse from \"parse\";\nimport User from \"../server/user\";\nimport userView from \"../components/UserView.vue\";\n// import Parse from \"parse\";\n\nexport default defineComponent({\n  components: { GoogleMap, Marker, Polyline, userView },\n  setup() {\n    const currentUser = Parse.User.current();\n\n    const center = { lat: 40.689247, lng: -74.044502 };\n    const formState = reactive({\n      image: \"\",\n      center: { lat: 40.689247, lng: -74.044502 },\n      loader: false,\n      data: [],\n      getData:[],\n      flag:false,\n      sharing:false,\n      start:null,\n      stop:null,\n      user:null\n    });\n    const line = reactive({\n      flightPath: {\n        path: formState.data,\n        geodesic: true,\n        strokeColor: \"#FF0000\",\n        strokeOpacity: 1.0,\n        strokeWeight: 2\n      }\n    });\n  \n    onMounted(async () => {\n      const currentUser = Parse.User.current();\n      if(currentUser){\n        formState.start=true\n        formState.stop=false,\n        formState.user=true\n      }\n      // const currentUser = Parse.User.current();\n      // await User.getPointer(currentUser.id).then((obj)=>{\n      //   var ldata =  currentUser.get('userLocation')\n      // })\n\n      // if(currentUser){\n      //   var ldata =  currentUser.get('userLocation')\n      //    console.log(\"ldata\",ldata)\n      //    formState.data=currentUser.get('userLocation')\n      //    console.log(formState.data[0])\n      // }\n\n      // getLocation();\n      startLocation()\n\n\n     \n      // window.setInterval(() => {\n      //   navigator.geolocation.getCurrentPosition(() => {});\n      //   getLocation();\n      // }, 9000); \n    });\n\n    const updateLocation = async () => {\n      if (navigator.geolocation) {\n        await navigator.geolocation.getCurrentPosition(position => {\n          formState.data.push({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          });\n          console.log(position.coords.latitude);\n          console.log(position.coords.longitude);\n\n          formState.center.lat = position.coords.latitude;\n          formState.center.lng = position.coords.longitude;\n        });\n      }\n    };\n\n    const getLocation = async () => {\n      const checkUseer = Parse.User.current();\n      // formState.loader = false;\n      if(checkUseer){\n        if (navigator.geolocation) {\n        // console.log(\"h\")\n        await navigator.geolocation.getCurrentPosition(async position => {\n          console.log(position.coords.latitude);\n          console.log(position.coords.longitude);\n          console.log(formState.data)\n          let myTarget = JSON.parse(JSON.stringify(formState.data))\n          console.log(myTarget)\n          formState.data.push({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          });\n          formState.getData.push({\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          });\n\n          // console.log(formState.center.lat)\n          formState.center.lat = position.coords.latitude;\n          formState.center.lng = position.coords.longitude;\n          \n          // const currentUser = Parse.User.current();\n          console.log(\"curremt user\",currentUser.get(\"username\"),currentUser.id)\n          await User.getPointer(currentUser.id).then(obj => {\n            currentUser.set({\n              \"userLocation\":formState.data\n              \n            })\n            currentUser.save().then(()=>{\n              console.log(\"saving............................\")\n            })\n            console.log(obj);\n          });\n         \n          formState.loader = true;\n        });\n      }\n      }\n \n    };\n    // setInterval(updateLocation, 5000);\n\n    const startLocation = async() => {\n      formState.flag=false\n      console.log(\"hi\")\n      // setTimeout(updateLocation, 1000);\n      currentUser.set({\n        'state':true\n      })\n\n      await currentUser.save()\n    var intervel =   window.setInterval(() => {\n      \n      console.log(\".......\")\n      \n        if(formState.flag){\n      console.log(\",,,,,,,,,,,,,,\")\n      formState.start=true\n      formState.stop=false\n          \n\n          window.clearInterval(intervel)\n        }\n        else{\n      console.log(\"!!!!!!!!!!!!!!!!\")\n      formState.start=false\n      formState.stop=true\n\n        getLocation();\n        }\n        // navigator.geolocation.getCurrentPosition(() => {});\n      }, 3000); \n      // clearInterval(startLocation());\n    };\n    const stopLocation = async()=>{\n      // formState.stop=false\n      currentUser.set({\n        'state':false\n      })\n\n      await currentUser.save()\n\n      console.log(\"stop\")\n\n      // clearInterval(startLocation());\n\n    \n      formState.flag=true\n\n      // formState.start=true\n     \n      // clearInterval(myInterval);\n\n    }\n\n    return {\n      center,\n      formState,\n      updateLocation,\n      startLocation,\n      getLocation,\n      line,\n      stopLocation\n    };\n  }\n});\n</script>\n"]},"metadata":{},"sourceType":"module"}